<tool id="picrust2_add_descriptions" name="Picrust2 Add Descriptions" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <description>column to a function abundance table and outputs a new file</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="edam_ontology"/>
    <expand macro="requirements"/>
    <version_command>add_descriptions.py -v</version_command>
    <command detect_errors="exit_code"><![CDATA[
add_descriptions.py
    --input '$input'
    --output 'added_description.tsv'
    --map_type '$map_type'
#if $custom_map_table    
    --custom_map_table '$custom_map_table'
#end if
    ]]></command>
    <inputs>
        <param argument="--input" type="data" format="tabular" label="Input function abundance table"/>
        <param argument="--map_type" type="select" label="Select which default mapping table should be used">
            <option value="METACYC">METACYC</option>
            <option value="COG">COG</option>
            <option value="EC">EC</option>
            <option value="KO">KO</option>
            <option value="PFAM">PFAM</option>
            <option value="TIGRFAM">TIGRFAM</option>
        </param>
        <param argument="--custom_map_table" type="data" format="tabular" optional="true" label="Custom Map Table" help="An input map table linking function ids to descriptions for each function"/>
    </inputs>
    <outputs>
        <data name="func_abun_table_description" format="tabular" from_work_dir="added_description.tsv">
        </data>
    </outputs>
    <tests>
    <test expect_num_outputs="1">
        <param name="input" ftype="tabular" value="pred_metagenome_unstrat.tsv.gz"/>
        <param name="map_type" value="EC"/>
        <output name="func_abun_table_description" ftype="tabular">
            <assert_contents>
                <has_text text="description"/>
                <has_n_lines n="1000"/>
            </assert_contents>
        </output>
    </test>
    </tests>
    <help><![CDATA[
@HELP_HEADER@

Add Descriptions
================
Adds a description column to a function abundance table and outputs a new file.

Note
====
The user needs to specify the input file and what type of functions are in the input table. Will throw an error if no ids overlap and otherwise will fill in "not_found" for the description of ids in the function table not in the mapfile.

Input
=====
Input function abundance table.

Output
======
Output function abundance table with added description column.
    ]]></help> 
    <citations>
        <citation type="doi">10.1038/s41587-020-0548-6</citation>
    </citations>
</tool>