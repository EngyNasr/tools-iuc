<tool id="picrust2_hsp" name="hsp" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <description>Hidden state prediction for 16S copy, E.C. numbers, and KO abundances per-genome</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="edam_ontology"/>
    <expand macro="requirements"/>
    <version_command>hsp.py -v</version_command>
    <command detect_errors="exit_code"><![CDATA[
hsp.py
    -t '$treefile'
    -i '$trait_option'
    -o '$output'
    -m '$method'
    -e '$float'
    --chunk_size '$chunk_size'
    -n '$NSTI'
    -p "\${GALAXY_SLOTS:-1}"
    ]]></command>
    <inputs>
        <param argument="-t" type="data" format="newick" label="Newick tree with study sequences placed amongst reference sequences"/>
        <param argument="-i" type="select" label="Which default pre-calculated count table to use (one of '16S', 'COG', 'EC', 'KO', 'PFAM', 'TIGRFAM', 'PHENO')">
            <option value="16S">16S</option>
            <option value="COG">COG</option>
            <option value="EC">EC</option>
            <option value="KO">KO</option>
            <option value="PFAM">PFAM</option>
            <option value="TIGRFAM">TIGRFAM</option>
            <option value="PHENO">PHENO</option>
        </param>
        <param argument="-o" type="text" label="Named of output file containing predicted counts">
            <sanitizer invalid_char="">
                <valid initial="string.ascii_letters,string.digits">
                    <add value="_" />
                    <add value="-" />
                </valid>
            </sanitizer>
            <validator type="empty_field" />
        </param>        
        <param argument="-m" type="select" label="Hidden-state prediction method to use, which needs to be one of: maximum parsimony (mp), empirical probabilities (emp_prob), subtree averaging (subtree_average), phylogenetic independent contrast (pic), or squared-change parsimony (scp)">
            <option value="mp">mp</option>
            <option value="emp_prob">emp_prob</option>
            <option value="subtree_average">subtree_average</option>
            <option value="pic">pic</option>
            <option value="scp">scp</option>
        </param>
        <param argument="-e" type="float" value="0.5" min="0" label="Setting for maximum parisomony hidden-state prediction. Specifies weighting transition costs by the inverse length of edge lengths. If 0, then edge lengths do not influence predictions. Must be a non-negative real-valued number (default: 0.5)"/>
        <param argument="--chunk_size" type="integer" label="Number of gene families to read in for a given processor. Note that increasing this value will not always speed up execution! The trait table is split into subsets of size chunk_size before running hidden state prediction to reduce memory usage. Each subset can be run through on a different processor, but the number of simultaneous processors is equal to the number of data subsets! For example, if there are 1500 total gene families and the chunk_size is 500, the maximum number of processes that can be run is parallel is 3 (which will be the case even if you set something higher!)"/>
        <param argument="-n" type="boolean" truevalue="-n" falsevalue="" checked="false" label="Indicates that Nearest-sequenced taxon index (NSTI) values should be calculated. "/>   
    </inputs>
    <outputs>
        <data name="predicted" format="tsv" label="Output for the Hidden State Prediction">
        </data>
    </outputs>
</tool>